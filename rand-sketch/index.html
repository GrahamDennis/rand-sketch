<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `rand-sketch` crate.">
    <meta name="keywords" content="rust, rustlang, rust-lang, rand-sketch">

    <title>rand-sketch - Rust</title>

    <link rel="stylesheet" type="text/css" href="../main.css">

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <section class="sidebar">
        
        <p class='location'></p><script>window.sidebarCurrent = {name: 'rand-sketch', ty: 'mod', relpath: '../'};</script>
    </section>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press 'S' to search, '?' for more options..."
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content mod">
<h1 class='fqn'><span class='in-band'>Crate <a class='mod' href=''>rand-sketch</a><wbr></span><span class='out-of-band'><a href='stability.html'>[stability]</a> <span id='render-detail'>
            <a id="collapse-all" href="#">[-]</a>&nbsp;<a id="expand-all" href="#">[+]</a>
        </span><a id='src-0' href='../src/rand-sketch/lib.rs.html#1-149'>[src]</a></span></h1>
<div class='docblock'>
<h2 id="todo:-update-text-for-the-stream-type." class='section-header'><a
                           href="#todo:-update-text-for-the-stream-type.">TODO: update text for the stream type.</a></h2>
<h1 id="updated-benchmarks" class='section-header'><a
                           href="#updated-benchmarks">Updated benchmarks</a></h1>
<table><thead>
<tr>
<th>bench</th>
<th>assoc</th>
<th>stream</th>
<th>typeparam</th>
<th>original</th>
</tr>
</thead><tbody>
<tr>
<td><code>gen_</code></td>
<td>708</td>
<td>706</td>
<td><strong>688</strong></td>
<td>717</td>
</tr>
<tr>
<td><code>iter</code></td>
<td><strong>262</strong></td>
<td><strong>265</strong></td>
<td>274</td>
<td>322</td>
</tr>
<tr>
<td><code>iter__noiterbb</code></td>
<td><strong>258</strong></td>
<td><strong>255</strong></td>
<td>270</td>
<td>263</td>
</tr>
<tr>
<td><code>range_gen</code></td>
<td>1292</td>
<td><strong>1247</strong></td>
<td><strong>1244</strong></td>
<td></td>
</tr>
<tr>
<td><code>range_gen__bb</code></td>
<td>3960</td>
<td>3937</td>
<td><strong>3847</strong></td>
<td></td>
</tr>
<tr>
<td><code>range_iter</code></td>
<td>765</td>
<td><strong>724</strong></td>
<td>1018</td>
<td></td>
</tr>
<tr>
<td><code>range_iter__bb</code></td>
<td>779</td>
<td><strong>665</strong></td>
<td>1088</td>
<td></td>
</tr>
<tr>
<td><code>range_iter__noiterbb</code></td>
<td><strong>384</strong></td>
<td>394</td>
<td>405</td>
<td></td>
</tr>
</tbody></table>

<h1 id="old-text" class='section-header'><a
                           href="#old-text">Old text</a></h1>
<p><code>assoc</code> and <code>typeparam</code> are two different ways to encode constraints
for <code>Random</code> (aka <code>Random</code>). <code>assoc</code> uses an associated type and
generic conversions to provide a nice API, with computations
&quot;front-loaded&quot;/cached if possible (particularly for
<code>gen_iter</code>). <code>typeparam</code> has an extra type parameter on <code>Random</code>, and
doesn&#39;t benefit from caching (i.e. assumes the optimiser will handle
everything).</p>

<h2 id="example" class='section-header'><a
                           href="#example">Example</a></h2>
<p>(of either <code>assoc</code> or <code>typeparam</code>, in the method form they
would use in a final API, which this crate doesn&#39;t implement)</p>
<pre id='rust-example-rendered' class='rust '>
<span class='comment'>// thread-local</span>
<span class='kw'>let</span> <span class='ident'>x</span>: <span class='ident'>u32</span> <span class='op'>=</span> <span class='ident'>rand</span>::<span class='ident'>random</span>(..);

<span class='comment'>// typed variable</span>
<span class='kw'>let</span> <span class='ident'>x</span>: <span class='ident'>u32</span> <span class='op'>=</span> <span class='ident'>rng</span>.<span class='ident'>gen</span>(..);
<span class='kw'>let</span> <span class='ident'>y</span>: <span class='ident'>f32</span> <span class='op'>=</span> <span class='ident'>rng</span>.<span class='ident'>gen</span>(<span class='ident'>a</span>..<span class='ident'>b</span>);

<span class='comment'>// inline type hint (extra type param compared to today)</span>
<span class='kw'>let</span> <span class='ident'>type_hint</span> <span class='op'>=</span> <span class='ident'>rng</span>.<span class='ident'>gen</span>::<span class='op'>&lt;</span><span class='ident'>i64</span>, _<span class='op'>&gt;</span>(..);
</pre>

<h2 id="benchmarks" class='section-header'><a
                           href="#benchmarks">Benchmarks</a></h2>
<pre><code class="language-text">test gen_assoc                      ... bench:       676 ns/iter (+/- 29)
test gen_original                   ... bench:       684 ns/iter (+/- 14)
test gen_typeparam                  ... bench:       681 ns/iter (+/- 13)
test iter__noiterbb_assoc           ... bench:       270 ns/iter (+/- 260)
test iter__noiterbb_original        ... bench:       252 ns/iter (+/- 14)
test iter__noiterbb_typeparam       ... bench:       262 ns/iter (+/- 15)
test iter_assoc                     ... bench:       264 ns/iter (+/- 29)
test iter_original                  ... bench:       313 ns/iter (+/- 31)
test iter_typeparam                 ... bench:       272 ns/iter (+/- 12)
test range_gen__bb_assoc            ... bench:      3894 ns/iter (+/- 252)
test range_gen__bb_typeparam        ... bench:      3909 ns/iter (+/- 420)
test range_gen_assoc                ... bench:      1263 ns/iter (+/- 64)
test range_gen_typeparam            ... bench:      1223 ns/iter (+/- 77)
test range_iter__bb_assoc           ... bench:       749 ns/iter (+/- 37)
test range_iter__bb_typeparam       ... bench:      1062 ns/iter (+/- 34)
test range_iter__noiterbb_assoc     ... bench:       370 ns/iter (+/- 23)
test range_iter__noiterbb_typeparam ... bench:       405 ns/iter (+/- 158)
test range_iter_assoc               ... bench:       738 ns/iter (+/- 30)
test range_iter_typeparam           ... bench:       986 ns/iter (+/- 65)
</code></pre>

<p>All benchmarks used <code>u32</code>.</p>

<h3 id="legend" class='section-header'><a
                           href="#legend">Legend</a></h3>
<ul>
<li><code>original</code> calls the relevant function from <code>std::rand</code> (aka crates.io&#39;s <code>rand</code>)</li>
<li><code>gen</code> calls <code>black_box(gen())</code> 100 times</li>
<li><code>iter</code> runs <code>for x in black_box(gen_iter()) { black_box(x) }</code></li>
<li><code>range</code> passes <code>4..321</code>, others just pass <code>..</code>.</li>
<li><code>range_*__bb</code> calls <code>black_box</code> on <code>4..321</code> before passing it</li>
<li><code>noiterbb</code> avoids the <code>black_box</code> around the <code>gen_iter</code> (i.e. let
the inliner/optimiser see everything)</li>
</ul>

<h3 id="summary" class='section-header'><a
                           href="#summary">Summary</a></h3>
<p>The associated type version is essentially always more performant than
the type parameter version. Especially for ranged <code>gen_iter</code>, where
caching the internal computations required for <code>u32</code> makes a noticable
difference, even when the compiler has full information (the
<code>noiterbb</code> case), and hence could theoretically lift the comptations
in <code>typeparam</code> out of the loop.</p>
</div><h2 id='modules' class='section-header'><a href="#modules">Modules</a></h2>
<table>
                    <tr>
                        <td><a class='stability Unmarked' title='No stability level'></a><a class='mod' href='assoc/index.html'
                               title='rand-sketch::assoc'>assoc</a></td>
                        <td class='docblock short'></td>
                    </tr>
                
                    <tr>
                        <td><a class='stability Unmarked' title='No stability level'></a><a class='mod' href='stream/index.html'
                               title='rand-sketch::stream'>stream</a></td>
                        <td class='docblock short'></td>
                    </tr>
                
                    <tr>
                        <td><a class='stability Unmarked' title='No stability level'></a><a class='mod' href='typeparam/index.html'
                               title='rand-sketch::typeparam'>typeparam</a></td>
                        <td class='docblock short'></td>
                    </tr>
                </table><h2 id='traits' class='section-header'><a href="#traits">Traits</a></h2>
<table>
                    <tr>
                        <td><a class='stability Unmarked' title='No stability level'></a><a class='trait' href='trait.Into.html'
                               title='rand-sketch::Into'>Into</a></td>
                        <td class='docblock short'></td>
                    </tr>
                </table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <div id="help" class="hidden">
        <div class="shortcuts">
            <h1>Keyboard shortcuts</h1>
            <dl>
                <dt>?</dt>
                <dd>Show this help dialog</dd>
                <dt>S</dt>
                <dd>Focus the search field</dd>
                <dt>&larrb;</dt>
                <dd>Move up in search results</dd>
                <dt>&rarrb;</dt>
                <dd>Move down in search results</dd>
                <dt>&#9166;</dt>
                <dd>Go to active search result</dd>
            </dl>
        </div>
        <div class="infos">
            <h1>Search tricks</h1>
            <p>
                Prefix searches with a type followed by a colon (e.g.
                <code>fn:</code>) to restrict the search to a given type.
            </p>
            <p>
                Accepted types are: <code>fn</code>, <code>mod</code>,
                <code>struct</code>, <code>enum</code>,
                <code>trait</code>, <code>typedef</code> (or
                <code>tdef</code>).
            </p>
        </div>
    </div>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "rand-sketch";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script async src="../search-index.js"></script>
</body>
</html>